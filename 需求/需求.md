
# 开发一个web端应用，来为当前trae agent提供一个可视化的界面

# 页面形态
top区域：用户选择workspace，即选定一个本地目录，作为web应用的工作目录。trae agent将获取该工作空间的文件操作权限，并且后续的任务在该空间下直接操作。
主视觉区：
- 左侧：工作空间文件列表，不断读取用户本地目录的.md格式文件，并以列表的方式呈现，用户选择可以切换，在主视觉去显示这个文件的内容
- Markdown工作区域，显示文件内容，用户也可以自行编辑，并提供保存按钮。分为编辑区（用户进行编辑，markdonw未渲染样式）和预览区（显示渲染后的样式）
- 右侧：trae agent操作页面，包括输出trae agent运行过程中的输出、工具调用等信息，进行流式打印。用户需求输入对话框，用户可以在这里输入自然语言描述的需求，然后点击提交。请求提交至trae agent后台，agent开始工作。

# 机制：
trae agent工作，使用文件操作工具，将最终生成的结果写入文件，并实时预览到主视觉去的markdonw中。
trae agent工作过程中的推理信息、工具调用信息，lakeview信息，可以实时打印

# 请使用react框架，使用脚手架实现需求


# 前端改动需求：
用户自定义助手时，需要填入以下信息：
1、助手名称（模式名称）
2、助手prompt（模式prompt）
3、自定义指导
4、任务未完成消息
5、反思规则：反思机制的反思工具中LLM的prompt
并进行保存。后续选择该助手时，Agent代码执行时将在相关方法内传入用户的自定义内容。
# 后台存储
以上数据使用Postgresql数据库存储。数据库固定端口，使用docker部署。
同时模型配置也使用postgresql保存，需要同步修改接口。
# Agent改动需求

当传入不同的prompt参数时，将同步影响以下相关信息，从而个性化trae agent运行机制。用户可以在前端页面自定义配置模式，模式包含以下几个方面：
1、模式名称 string 用户自定义模式名称，用于区分不同的运行模式。现在已经定义好了两个模式：文档助手、代码助手
2、模式prompt string
    代码位置：trae_agent/prompt/agent_prompt.py 
    用户在前端自定义模式prompt，代码中需要定一个可以灵活传入的 PROMPT={用户自定义的prompt}，在后续代码中被引用。现在已经定义好了两个prompt分别对应文档助手和代码助手。
3、自定义指导 string
    用户可以自定义一段指导语句，来指导LLM工作，这段指导语将会构建在usermessage中。
    
    代码位置：trae_agent/agent/trae_agent.py
    user_message = f"""
    [Project root path]:{self.project_path}
 
    [Problem statement]: We're currently solving the following issue within our repository. Here's the issue text:
    {extra_args['issue']}
 
    # 添加你的自定义指导
    [Special instructions]: 你的特殊指导语
    """
 
4、任务未完成消息
    代码位置：trae_agent/agent/trae_agent.py 的 task_incomplete_message 方法
    自定义指导语
5、反思机制
    需要增加文档质量审查工具，当前端传入prompt=‘文档助手’时，trae agent对于用户有关于‘大纲’、‘内容’、‘生成’、‘改写’等需求，并通过文件操作工具进行文档操作，需要对tool calls中的arguments.file_text 字段传入到文档质量审查工具中，进行质量检查。文档质量审查工具的输出结果，传入 reflect_on_result() 进行反思，从而影响agent下一步操作。文档审查工具的反思规则，可以让用户在前端进行自定义输入。
    代码位置：trae_agent/agent/trae_agent.py 的 reflect_on_result 方法 reflections.extend 



